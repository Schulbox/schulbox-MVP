import{c as L}from"/build/_shared/chunk-BZPDBGCT.js";import{a as _}from"/build/_shared/chunk-EFP3IDIJ.js";import"/build/_shared/chunk-5EDNXG7T.js";import{a as C}from"/build/_shared/chunk-VZQVWFLO.js";import{b,h as v,l as x,m as y}from"/build/_shared/chunk-YBGD6IQF.js";import{a as z,b as N}from"/build/_shared/chunk-TANAHWHW.js";import{e as s}from"/build/_shared/chunk-ADMCF34Z.js";var t=s(z(),1);var R=s(C(),1),D=s(L(),1),U=s(_(),1),e=s(N(),1);function w(){let{profile:i,error:c,needsClientAuth:d}=x(),a=y(),m=b(),[A,S]=(0,t.useState)(!0),[r,u]=(0,t.useState)(null),[k,f]=(0,t.useState)(!1),[F,p]=(0,t.useState)(!1),[P,E]=(0,t.useState)("");(0,t.useEffect)(()=>{if(d){if(!(localStorage.getItem("sb-is-logged-in")==="true")){m("/login");return}let l=localStorage.getItem("user-profile-cache");if(l)try{let n=JSON.parse(l);u(n)}catch(n){console.error("[ProfilPage] Fehler beim Parsen des Benutzer-Caches:",n)}}else i&&u(i);S(!1)},[i,d,m]),(0,t.useEffect)(()=>{a?.success?(f(!0),setTimeout(()=>f(!1),3e3),r&&(localStorage.setItem("user-profile-cache",JSON.stringify(r)),localStorage.setItem("user-profile-cache-time",Date.now().toString()))):a?.error&&(E(a.error),p(!0),setTimeout(()=>p(!1),3e3))},[a,r]);let o=g=>{let{name:l,value:n}=g.target;u(h=>h?{...h,[l]:n}:null)};return A?(0,e.jsx)("div",{className:"max-w-4xl mx-auto p-6 mt-8",children:(0,e.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):(0,e.jsxs)("div",{className:"max-w-4xl mx-auto p-6 mt-8",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Mein Profil"}),c&&(0,e.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:c}),k&&(0,e.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded mb-6",children:"Profil erfolgreich aktualisiert!"}),F&&(0,e.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:P}),r&&(0,e.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,e.jsxs)("div",{className:"mb-6 pb-4 border-b",children:[(0,e.jsx)("p",{className:"text-sm text-gray-600",children:"E-Mail-Adresse (nicht \xE4nderbar)"}),(0,e.jsx)("p",{className:"font-medium",children:r.email})]}),(0,e.jsxs)(v,{method:"post",className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"vorname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Vorname"}),(0,e.jsx)("input",{id:"vorname",name:"vorname",type:"text",value:r.vorname||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"nachname",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nachname"}),(0,e.jsx)("input",{id:"nachname",name:"nachname",type:"text",value:r.nachname||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{className:"md:col-span-2",children:[(0,e.jsx)("label",{htmlFor:"adresse",className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse"}),(0,e.jsx)("input",{id:"adresse",name:"adresse",type:"text",value:r.adresse||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"plz",className:"block text-sm font-medium text-gray-700 mb-1",children:"PLZ"}),(0,e.jsx)("input",{id:"plz",name:"plz",type:"text",value:r.plz||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"ort",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ort"}),(0,e.jsx)("input",{id:"ort",name:"ort",type:"text",value:r.ort||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"telefon",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefonnummer"}),(0,e.jsx)("input",{id:"telefon",name:"telefon",type:"tel",value:r.telefon||"",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Rolle"}),(0,e.jsxs)("select",{id:"role",name:"role",value:r.role||"lehrkraft",onChange:o,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,e.jsx)("option",{value:"eltern",children:"Eltern"}),(0,e.jsx)("option",{value:"lehrkraft",children:"Lehrkraft"})]})]})]}),(0,e.jsx)("div",{className:"flex justify-end",children:(0,e.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md px-4 py-2 disabled:opacity-50",children:"\xC4nderungen speichern"})})]})]})]})}export{w as default};
