import{a as _}from"/build/_shared/chunk-VZQVWFLO.js";import{d as m,h as u,l as p,m as g}from"/build/_shared/chunk-YBGD6IQF.js";import{a as T,b}from"/build/_shared/chunk-TANAHWHW.js";import{c as n,e as a}from"/build/_shared/chunk-ADMCF34Z.js";var f=n((q,h)=>{h.exports={}});var y=n((C,x)=>{x.exports={}});var N=n((K,v)=>{v.exports={}});var L=a(_(),1);var D=a(f(),1),w=a(T(),1),z=a(y(),1),k=a(N(),1),e=a(b(),1);function P(){let{user:S,hasToken:F,products:o}=p(),r=g(),d=m(),[s,c]=(0,w.useState)([]),i=(()=>o.filter(t=>s.includes(t.id)).reduce((t,l)=>t+parseFloat(l.variants[0].price),0))(),A=i*1.1,j=t=>{s.includes(t)?c(s.filter(l=>l!==t)):c([...s,t])};return(0,e.jsxs)("div",{className:"p-8 max-w-6xl mx-auto",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\u{1F4E6} Schulbox-Konfigurator"}),(0,e.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:["Eingeloggt als ",S.email]}),F?(0,e.jsx)(e.Fragment,{children:r?.success?(0,e.jsxs)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",children:[(0,e.jsx)("p",{className:"font-medium",children:r.message}),(0,e.jsx)("p",{className:"mt-2",children:"Die Schulbox wurde erfolgreich erstellt und ist jetzt im Shop verf\xFCgbar."}),(0,e.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,e.jsx)("a",{href:`https://nqwde0-ua.myshopify.com/products/${r?.product?.handle??""}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:"Schulbox im Shop ansehen"}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300 transition",children:"Neue Schulbox erstellen"})]})]}):(0,e.jsxs)(u,{method:"post",className:"space-y-8",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h2",{className:"text-xl font-semibold",children:"Schulbox-Details"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"schulname",className:"block text-sm font-medium text-gray-700",children:"Schulname *"}),(0,e.jsx)("input",{type:"text",id:"schulname",name:"schulname",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"klasse",className:"block text-sm font-medium text-gray-700",children:"Klasse *"}),(0,e.jsx)("input",{type:"text",id:"klasse",name:"klasse",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"jahrgang",className:"block text-sm font-medium text-gray-700",children:"Jahrgang *"}),(0,e.jsx)("input",{type:"text",id:"jahrgang",name:"jahrgang",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"lieferdatum",className:"block text-sm font-medium text-gray-700",children:"Lieferdatum *"}),(0,e.jsx)("input",{type:"date",id:"lieferdatum",name:"lieferdatum",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Preis\xFCbersicht"}),(0,e.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,e.jsxs)("div",{className:"flex justify-between py-2",children:[(0,e.jsx)("span",{children:"Zwischensumme:"}),(0,e.jsxs)("span",{children:[i.toFixed(2)," \u20AC"]})]}),(0,e.jsxs)("div",{className:"flex justify-between py-2 text-green-700",children:[(0,e.jsx)("span",{children:"+10% f\xFCr gesch\xFCtzte Werkst\xE4tte:"}),(0,e.jsxs)("span",{children:[(i*.1).toFixed(2)," \u20AC"]})]}),(0,e.jsxs)("div",{className:"flex justify-between py-2 font-bold border-t border-gray-300 mt-2 pt-2",children:[(0,e.jsx)("span",{children:"Gesamtpreis:"}),(0,e.jsxs)("span",{children:[A.toFixed(2)," \u20AC"]})]})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Produkte ausw\xE4hlen"}),o.length===0?(0,e.jsx)("p",{className:"text-gray-500",children:"Keine Produkte verf\xFCgbar."}):(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(t=>(0,e.jsxs)("div",{className:`border rounded-md p-4 cursor-pointer transition ${s.includes(t.id)?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-300"}`,onClick:()=>j(t.id),children:[(0,e.jsxs)("div",{className:"flex items-start gap-3",children:[(0,e.jsx)("input",{type:"checkbox",checked:s.includes(t.id),onChange:()=>{},className:"mt-1"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"font-medium",children:t.title}),(0,e.jsxs)("p",{className:"text-gray-600 text-sm mt-1",children:[parseFloat(t.variants[0].price).toFixed(2)," \u20AC"]})]})]}),s.includes(t.id)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("input",{type:"hidden",name:"selectedProducts",value:t.id}),(0,e.jsx)("input",{type:"hidden",name:`product_title_${t.id}`,value:t.title}),(0,e.jsx)("input",{type:"hidden",name:`product_price_${t.id}`,value:t.variants[0].price})]})]},t.id))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("button",{type:"submit",disabled:d.state==="submitting"||s.length===0,className:"bg-blue-600 text-white px-6 py-3 rounded-md font-medium hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:d.state==="submitting"?"Schulbox wird erstellt...":"Schulbox erstellen"}),s.length===0&&(0,e.jsx)("p",{className:"text-red-500 text-sm mt-2",children:"Bitte w\xE4hlen Sie mindestens ein Produkt aus."}),r?.success===!1&&(0,e.jsx)("p",{className:"text-red-500 text-sm mt-2",children:r.message})]})]})}):(0,e.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-6",children:[(0,e.jsx)("p",{className:"font-medium",children:"Shopify-Verbindung erforderlich"}),(0,e.jsx)("p",{className:"text-sm mt-1",children:"Um den Konfigurator nutzen zu k\xF6nnen, m\xFCssen Sie zuerst eine Verbindung zu Shopify herstellen."}),(0,e.jsx)("a",{href:"/auth/shopify",className:"mt-3 inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:"Mit Shopify verbinden"})]})]})}export{P as default};
